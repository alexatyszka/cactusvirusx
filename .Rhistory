for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
pairwise.dist <- get.tree.dist(cross.data,nj.gg)
max(pairwise.dist[pairwise.dist!=0])
mean(pairwise.dist[pairwise.dist!=0])
pairwise.dist
tips.cross <- c()
for (i in 1:length(tips.store)){
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
tips.cross
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
d<- c()
get.tree.dist = function(solcross.data,pathd8.tre)
{
for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
cross.data
pairwise.dist <- get.tree.dist(cross.data,nj.gg)
max(pairwise.dist[pairwise.dist!=0])
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
tips.store
tips.cross <- c()
for (i in 1:length(tips.store)){
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
d<- c()
get.tree.dist = function(solcross.data,pathd8.tre)
{
for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
d<- c()
get.tree.dist = function(solcross.data,pathd8.tre)
{
for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
pairwise.dist <- get.tree.dist(cross.data,nj.gg)
max(pairwise.dist[pairwise.dist!=0])
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
tips.cross <- c()
for (i in 1:length(tips.store)){
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
tips.store
d<- c()
get.tree.dist = function(solcross.data,pathd8.tre)
{
for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
pairwise.dist <- get.tree.dist(cross.data,nj.gg)
max(pairwise.dist[pairwise.dist!=0])
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
tips.cross <- c()
for (i in 1:length(tips.store)){
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
d<- c()
get.tree.dist = function(solcross.data,pathd8.tre)
{
for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
pairwise.dist <- get.tree.dist(cross.data,nj.gg)
max(pairwise.dist[pairwise.dist!=0])
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
plot.new()
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
tips.cross <- c()
for (i in 1:length(tips.store)){
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
d<- c()
get.tree.dist = function(solcross.data,pathd8.tre)
{
for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
pairwise.dist <- get.tree.dist(cross.data,nj.gg)
max(pairwise.dist[pairwise.dist!=0])
plot.new()
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
tips.cross <- c()
for (i in 1:length(tips.store)){
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
tips.cross <- c()
for (i in 1:length(tips.store)){
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
d<- c()
get.tree.dist = function(solcross.data,pathd8.tre)
{
for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
pairwise.dist <- get.tree.dist(cross.data,nj.gg)
max(pairwise.dist[pairwise.dist!=0])
library(ggtree) # tree plotting
library(DECIPHER)
library(RCurl) # web page loading
library(phangorn)
library(phytools)
library(ape)
library("knitr")
library(DECIPHER)
library(treeio)
cvx.metadata <- read.csv('../data/cvx_hostdata_v3.csv', stringsAsFactors = FALSE)
tre.f  <- "../data/iqtree-output/genbank_kr_consensus_extraction_al_trimmed.fasta.newick"
cvx.newick.tree <- read.newick(tre.f)
#create vector for host information
nj.gg <- reroot(cvx.newick.tree, node.number = 114)
hostinfo <- c()
hostinfo <- data.frame(nj.gg$tip.label)
#rename tree tips and populate vector
tip.rename.org = function(tree,dataframe){
for(i in 1:length(tree$tip.label)){
hostinfo$nj.gg.tip.label[i] <<- dataframe$host[grep(tree$tip.label[i],dataframe$Name)]
#uncomment these for troubleshooting:
#print(i)
#print(tree$tip.label[i])
#print(dataframe$Organism[grep(tree$tip.label[i],dataframe$Name)])
tree$tip.label[i]<-dataframe$Organism[grep(tree$tip.label[i],dataframe$Name)]
}
tree
}
nj.gg <- tip.rename.org(nj.gg,cvx.metadata)
plot.new()
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
tips.cross <- c()
for (i in 1:length(tips.store)){
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
d<- c()
get.tree.dist = function(solcross.data,pathd8.tre)
{
for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
pairwise.dist <- get.tree.dist(cross.data,nj.gg)
max(pairwise.dist[pairwise.dist!=0])
d<- c()
get.tree.dist = function(solcross.data,pathd8.tre)
{
for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
pairwise.dist <- get.tree.dist(cross.data,nj.gg)
cross.data
pairwise.dist
heatmap(pairwise.dist)
view(pairwise.dist)
heatmap(matrix(pairwise.dist))
typeof(pairwise.dist)
pairwise.dist[1]
pairwise.dist[2]
?matrix
tips.store
length(tips.store)
matrix(data=pairwise.dist, nrow=18, ncol=18)
m <- matrix(data=pairwise.dist, nrow=18, ncol=18)
heatmap(m)
view(m)
?view
View(m)
par( mar=c(1, 1, 0, 0))
L <- nj.gg$Nnode + length(nj.gg$tip.label)
ggtree(nj.gg, ladderize=T, aes(), show.legend = TRUE, size=0.2)  %<+% hostinfo+
#name tip labels:
geom_tiplab(aes(label=nj.gg$tip.label[1:L]), hjust=0, offset=0, align=T, linetype = "dotted")+
#host tip labels:
geom_tiplab(aes(label=hostinfo$nj.gg.tip.label[1:L]), align = T, linetype = 'blank', na.rm=TRUE, offset=0.3) +
#scale
geom_treescale(x=0, y=60, fontsize = 3) +
#node labels:
geom_text2(aes(subset = !isTip, label=label, hjust=-0.5)) +
#geom_hilight(node=136, fill="steelblue", alpha=.6, extend=0.5)+
xlim(0,2)
par( mar=c(1, 1, 0, 0))
L <- nj.gg$Nnode + length(nj.gg$tip.label)
ggtree(nj.gg, ladderize=T, aes(), show.legend = TRUE, size=0.2)  %<+% hostinfo+
#name tip labels:
geom_tiplab(aes(label=nj.gg$tip.label[1:L]), hjust=0, offset=0, align=T, linetype = "dotted")+
#host tip labels:
geom_tiplab(aes(label=hostinfo$nj.gg.tip.label[1:L]), align = T, linetype = 'blank', na.rm=TRUE, offset=0.3) +
#scale
geom_treescale(x=0, y=60, fontsize = 3) +
#node labels:
geom_text2(aes(subset = !isTip, label=label, hjust=-0.5)) +
#geom_hilight(node=136, fill="steelblue", alpha=.6, extend=0.5)+
xlim(0,2)
par( mar=c(1, 1, 0, 0))
L <- nj.gg$Nnode + length(nj.gg$tip.label)
ggtree(nj.gg, ladderize=T, aes(), show.legend = TRUE, size=0.2)  %<+% hostinfo+
#name tip labels:
geom_tiplab(aes(label=nj.gg$tip.label[1:L]), hjust=0, offset=0, align=T, linetype = "dotted")+
#host tip labels:
geom_tiplab(aes(label=hostinfo$nj.gg.tip.label[1:L]), align = T, linetype = 'blank', na.rm=TRUE, offset=0.3) +
#scale
geom_treescale(x=0, y=60, fontsize = 3) +
#node labels:
geom_text2(aes(subset = !isTip, label=label, hjust=-0.5)) +
#geom_hilight(node=136, fill="steelblue", alpha=.6, extend=0.5)+
xlim(0,2)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
tips.store
tips.cross <- c()
for (i in 1:length(tips.store)){
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
tips.cross
filename = paste(gsub(":", "-", Sys.time()),"_bootstrap_tree.pdf",sep="")
ggsave(filename, width = 60, height = 40, units = "cm", limitsize = FALSE)
nj.gg <- ladderize(nj.gg)
#create vector for host information
nj.gg <- reroot(cvx.newick.tree, node.number = 114)
nj.gg <- ladderize(nj.gg)
hostinfo <- c()
hostinfo <- data.frame(nj.gg$tip.label)
#rename tree tips and populate vector
tip.rename.org = function(tree,dataframe){
for(i in 1:length(tree$tip.label)){
hostinfo$nj.gg.tip.label[i] <<- dataframe$host[grep(tree$tip.label[i],dataframe$Name)]
#uncomment these for troubleshooting:
#print(i)
#print(tree$tip.label[i])
#print(dataframe$Organism[grep(tree$tip.label[i],dataframe$Name)])
tree$tip.label[i]<-dataframe$Organism[grep(tree$tip.label[i],dataframe$Name)]
}
tree
}
nj.gg <- tip.rename.org(nj.gg,cvx.metadata)
plot.new()
plot(nj.gg,cex=0.25)
nj.gg <- ladderize(nj.gg)
plot(nj.gg,cex=0.25)
plot.new()
nj.gg <- ladderize(nj.gg)
plot(nj.gg,cex=0.25)
nj.gg <- ladderize(nj.gg, right=TRUE)
nj.gg <- ladderize(nj.gg, right=TRUE)
plot(nj.gg,cex=0.25)
plot.new()
nj.gg <- ladderize(nj.gg, right=FALSE)
plot.new()
nj.gg <- ladderize(nj.gg, right=FALSE)
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
for (i in 1:length(tips.store)){
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
d<- c()
d<- c()
get.tree.dist = function(solcross.data,pathd8.tre)
{
for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
pairwise.dist <- get.tree.dist(cross.data,nj.gg)
max(pairwise.dist[pairwise.dist!=0])
tips.store
knitr::opts_chunk$set(error = TRUE)
#install needed packages
install.packages('BiocManager')# This option gave B errors; repos=c('https://cran.rstudio.com'), ask=F)
BiocManager::install('DECIPHER')
library(ggtree) # tree plotting
library(DECIPHER)
library(RCurl) # web page loading
library(phangorn)
library(phytools)
library(ape)
library("knitr")
library(DECIPHER)
library(treeio)
cvx.metadata <- read.csv('../data/cvx_hostdata_v3.csv', stringsAsFactors = FALSE)
tre.f  <- "../data/iqtree-output/genbank_kr_consensus_extraction_al_trimmed.fasta.newick"
cvx.newick.tree <- read.newick(tre.f)
#create vector for host information
nj.gg <- reroot(cvx.newick.tree, node.number = 114)
hostinfo <- c()
hostinfo <- data.frame(nj.gg$tip.label)
#rename tree tips and populate vector
tip.rename.org = function(tree,dataframe){
for(i in 1:length(tree$tip.label)){
hostinfo$nj.gg.tip.label[i] <<- dataframe$host[grep(tree$tip.label[i],dataframe$Name)]
#uncomment these for troubleshooting:
#print(i)
#print(tree$tip.label[i])
#print(dataframe$Organism[grep(tree$tip.label[i],dataframe$Name)])
tree$tip.label[i]<-dataframe$Organism[grep(tree$tip.label[i],dataframe$Name)]
}
tree
}
nj.gg <- tip.rename.org(nj.gg,cvx.metadata)
plot.new()
nj.gg <- ladderize(nj.gg, right=FALSE)
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
tips.cross <- c()
for (i in 1:length(tips.store)){
print(nj.gg$tip.label[tips.store[i]])
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
tips.cross <- c()
for (i in 1:length(tips.store)){
print(nj.gg$tip.label[tips.store[i]])
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
tipstips.cross
tips.cross
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
tips.store
tips.cross <- c()
for (i in 1:length(tips.store)){
print(nj.gg$tip.label[tips.store[i]])
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
d<- c()
get.tree.dist = function(solcross.data,pathd8.tre)
{
for(i in 1:length(solcross.data$tip1))
{
ifelse(is.na(match(solcross.data$tip1[i],pathd8.tre$tip.label)) | is.na(match(solcross.data$tip2[i],pathd8.tre$tip.label)),d[i]<-NA,
d[i]<-cophenetic.phylo(pathd8.tre)[solcross.data$tip1[i],solcross.data$tip2[i]])
}
return(d)
}
pairwise.dist <- get.tree.dist(cross.data,nj.gg)
max(pairwise.dist[pairwise.dist!=0])
pairwise.dist
View(pairwise.dist)
cophenetic.phylo(nj.gg)[1,1]
cophenetic.phylo(nj.gg)[2,2]
tips.store
tips.cross
cophenetic.phylo(nj.gg)["Cactus virus X: AF308158.2", "Cactus virus X: AF308158.2"]
cophenetic.phylo(nj.gg)["Cactus virus X: AF308158.2", "Virus from 15H5P__p_S54"]
distTips(nj.gg)
dist.nodes(nj.gg)
View(dist.nodes(nj.gg))
View(dist.nodes(nj.gg))
tips.cross
heatmap(dist.nodes(nj.gg))
library(ggtree) # tree plotting
library(DECIPHER)
library(RCurl) # web page loading
library(phangorn)
library(phytools)
library(ape)
library("knitr")
library(DECIPHER)
library(treeio)
cvx.metadata <- read.csv('../data/cvx_hostdata_v3.csv', stringsAsFactors = FALSE)
tre.f  <- "../data/iqtree-output/genbank_kr_consensus_extraction_al_trimmed.fasta.newick"
cvx.newick.tree <- read.newick(tre.f)
#create vector for host information
nj.gg <- reroot(cvx.newick.tree, node.number = 114)
hostinfo <- c()
hostinfo <- data.frame(nj.gg$tip.label)
#rename tree tips and populate vector
tip.rename.org = function(tree,dataframe){
for(i in 1:length(tree$tip.label)){
hostinfo$nj.gg.tip.label[i] <<- dataframe$host[grep(tree$tip.label[i],dataframe$Name)]
#uncomment these for troubleshooting:
#print(i)
#print(tree$tip.label[i])
#print(dataframe$Organism[grep(tree$tip.label[i],dataframe$Name)])
tree$tip.label[i]<-dataframe$Organism[grep(tree$tip.label[i],dataframe$Name)]
}
tree
}
plot.new()
nj.gg <- ladderize(nj.gg, right=FALSE)
plot(nj.gg,cex=0.25)
tips.store <- identify(nj.gg, nodes = TRUE, tips = TRUE,labels = FALSE, quiet = FALSE)$tips
#optional tip selection here, otherwise use tip numbers of desired clade
tips.cross <- c()
for (i in 1:length(tips.store)){
print(nj.gg$tip.label[tips.store[i]])
tips.cross[i] <- nj.gg$tip.label[tips.store[i]]
}
cross.data <- expand.grid(tip1 = tips.cross, tip2 = tips.cross)
##percent sequence identity test
unal.f <- '../data/genbank_kr_consensus_extraction_unal.fasta'
unal.f <- '../data/genbank_kr_consensus_extraction_unal.fasta'
al.f <- '../data/genbank_kr_consensus_extraction_al.fasta'
unal.dna <- readDNAStringSet(unal.f)
library(DECIPHER)
unal.dna <- readDNAStringSet(unal.f)
##percent sequence identity test
unal.f <- '../data/genbank_kr_consensus_extraction_al_trimmed.fasta'
al.f <- '../data/genbank_kr_consensus_extraction_al.fasta'
unal.dna <- readDNAStringSet(unal.f)
getwd()
##percent sequence identity test
unal.f <- '/Users/alexa/Desktop/cactusvirusx/data/genbank_kr_consensus_extraction_al_trimmed.fasta'
unal.dna <- readDNAStringSet(unal.f)
##percent sequence identity test
al.f <- '/Users/alexa/Desktop/cactusvirusx/data/genbank_kr_consensus_extraction_al_trimmed.fasta'
al.dna <- readDNAStringSet(al.f)
aligned.cvx.fasta <- read.fasta(al.f)
aligned.cvx.phydat <- read.phyDat(al.dna, format='fasta', type='DNA')
library(phangorn)
aligned.cvx.phydat <- read.phyDat(al.dna, format='fasta', type='DNA')
aligned.cvx.phydat <- read.phyDat('al.f', format='fasta', type='DNA')
##percent sequence identity test
al.f <- '/Users/alexa/Desktop/cactusvirusx/data/genbank_kr_consensus_extraction_al_trimmed.fasta'
al.dna <- readDNAStringSet(al.f)
aligned.cvx.phydat <- read.phyDat('al.f', format='fasta', type='DNA')
##percent sequence identity test
setwd(/Users/alexa/Desktop/cactusvirusx/)
##percent sequence identity test
setwd('/Users/alexa/Desktop/cactusvirusx/')
al.f <- '/Users/alexa/Desktop/cactusvirusx/data/genbank_kr_consensus_extraction_al_trimmed.fasta'
al.f <- '../data/genbank_kr_consensus_extraction_al_trimmed.fasta'
al.dna <- readDNAStringSet(al.f)
al.f <- '/data/genbank_kr_consensus_extraction_al_trimmed.fasta'
al.dna <- readDNAStringSet(al.f)
aligned.cvx.phydat <- read.phyDat('al.f', format='fasta', type='DNA')
al.dna <- readDNAStringSet(al.f)
al.f <- '../data/genbank_kr_consensus_extraction_al_trimmed.fasta'
al.dna <- readDNAStringSet(al.f)
##percent sequence identity test
setwd('/Users/alexa/Desktop/cactusvirusx/')
al.f <- '/Users/alexa/Desktop/cactusvirusx/data/genbank_kr_consensus_extraction_al_trimmed.fasta'
al.dna <- readDNAStringSet(al.f)
aligned.cvx.phydat <- read.phyDat('al.dna', format='fasta', type='DNA')
aligned.cvx.phydat <- read.phyDat(al.dna, format='fasta', type='DNA')
aligned.cvx.phydat <- read.phyDat(al.f, format='fasta', type='DNA')
aligned.cvx.bin <- as.DNAbin(aligned.cvx.phydat)
dist.matrix <- dist.dna(aligned.cvx.bin, model = "raw")
view(dist.matrix)
View(dist.matrix)
dist.matrix <- dist.dna(aligned.cvx.bin, model = "raw", as.matrix=TRUE)
View(dist.matrix)
View(dist.matrix)
heatmap(dist.matrix)
